<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>ã‚«ã‚²ãƒã‚¹ç§˜å¯†åŸºåœ°Î²</title>
    <meta name="description" content="ã‚«ã‚²ãƒã‚¹ã®æ‹ ç‚¹ãƒªã‚½ãƒ¼ã‚¹ï¼ˆçŸ³ãƒ»æœ¨ãƒ»ã‚³ã‚¤ãƒ³ï¼‰ã®æœ€çŸ­é”æˆäººå“¡é…ç½®ã‚’è¨ˆç®—ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚">
    <meta property="og:title" content="ã‚«ã‚²ãƒã‚¹ç§˜å¯†åŸºåœ° - è³‡æºæœ€é©åŒ–ãƒ„ãƒ¼ãƒ«">
    <meta property="og:description" content="æ‹ ç‚¹Lvã€ç¾åœ¨æ•°ã€ç›®æ¨™æ•°ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€æœ€çŸ­æ™‚é–“ã§é”æˆã§ãã‚‹äººå“¡é…ç½®ã‚’è‡ªå‹•è¨ˆç®—ã—ã¾ã™ã€‚">
    <meta property="og:type" content="website">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ°</text></svg>">
    <style>
        :root {
            --bg-color: #202020;
            --surface-color: #2c2c2c;
            --border-color: #444;
            --input-bg: #1a1a1a;
            --accent-color: #60cdff;
            --text-primary: #eee;
            --text-secondary: #aaa;
            --warn-color: #ffcc00;
            --danger-color: #ff6b6b;
            --success-color: #66ff99;
        }

        body {
            font-family: sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            padding: 15px;
            margin: 0;
            display: flex;
            justify-content: center;
        }

        .container { width: 100%; max-width: 480px; display: flex; flex-direction: column; gap: 15px; padding-bottom: 50px; }

        .card {
            background-color: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .row-header {
            display: flex;
            font-size: 11px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            padding-bottom: 4px;
            border-bottom: 1px solid var(--border-color);
        }
        .h-name { width: 25%; }
        .h-lv { width: 20%; text-align: center; }
        .h-val { width: 55%; text-align: right; padding-right: 4px;}

        /* å…¥åŠ›è¡Œ */
        .input-row { display: flex; align-items: center; margin-bottom: 10px; height: 34px; }
        .input-row:last-child { margin-bottom: 0; }
        
        .col-label { width: 25%; font-weight: bold; font-size: 13px; display: flex; flex-direction: column; justify-content: center; line-height: 1.2;}
        .col-desc { font-size: 10px; color: #888; font-weight: normal; }

        .col-lv { width: 20%; display: flex; justify-content: center; align-items: center; border-right: 1px solid #444; margin-right: 8px; padding-right: 8px; }
        
        .col-val { flex: 1; display: flex; gap: 6px; justify-content: flex-end; align-items: center; }

        input[type="number"] {
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            color: #fff;
            padding: 8px 4px;
            border-radius: 4px;
            text-align: center;
            font-size: 14px;
            width: 100%;
        }
        input:focus { border-color: var(--accent-color); outline: none; }
        
        /* Lvå…¥åŠ›æ¬„ï¼ˆçŸ¢å°ã‚ã‚Šï¼‰ */
        .input-lv { width: 40px !important; text-align: center; font-weight: bold; color: var(--accent-color); }
        
        /* è³‡æºå…¥åŠ›æ¬„ï¼ˆçŸ¢å°ãªã—ãƒ»å³å¯„ã›ï¼‰ */
        .input-res { 
            text-align: right; 
            font-size: 13px; 
            -moz-appearance: textfield;
        }
        .input-res::-webkit-outer-spin-button,
        .input-res::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        /* å¸ä»¤éƒ¨ãƒ‘ãƒãƒ« */
        .strategy-card {
            background: rgba(96, 205, 255, 0.1);
            border: 2px solid var(--accent-color);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            display: none; 
            animation: fadeIn 0.5s;
        }
        .strategy-title { font-size: 10px; font-weight: bold; letter-spacing: 2px; margin-bottom: 6px; opacity: 0.8; text-transform: uppercase; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:5px;}
        .strategy-action { font-size: 18px; font-weight: bold; margin-bottom: 5px; color: #fff; line-height: 1.2; }
        .strategy-reason { font-size: 12px; color: #ccc; margin-top: 4px; }

        .result-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 8px 0; border-bottom: 1px solid #333; font-size: 14px;
        }
        .res-full { color: var(--warn-color); font-size: 10px; border: 1px solid var(--warn-color); padding: 0 3px; border-radius: 2px; margin-left: 4px;}
        .res-ok { color: #888; font-size: 10px; margin-left: 4px;}

        .reset-btn {
            background: none; border: none; color: #555; font-size: 11px; cursor: pointer; text-decoration: underline; margin-top: 20px;
        }
        .reset-btn:hover { color: var(--danger-color); }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body onload="init()">

<div class="container">

    <h1 style="text-align:center; margin:0 0 10px 0; font-size:18px; color:var(--accent-color); letter-spacing:2px; text-transform:uppercase;">
        ğŸ° ã‚«ã‚²ãƒã‚¹ç§˜å¯†åŸºåœ°Î²(ãƒ†ã‚¹ãƒˆä¸­)
    </h1>
    
    <div class="card">
        <div class="row-header">
            <span class="h-name">åŸºæœ¬è¨­å®š</span>
            <span class="h-lv">Lv</span>
            <span class="h-val">æƒ…å ±</span>
        </div>
        
        <div class="input-row">
            <div class="col-label">æ‹ ç‚¹<span class="col-desc">ã‚·ãƒ£ãƒ‰ã‚¦</span></div>
            <div class="col-lv"><input type="number" id="lvBase" class="input-lv" value="14" oninput="calculate()" onkeydown="moveFocus(event, 'lvHousing')"></div>
            <div class="col-val" style="justify-content:flex-start; font-size:11px; color:#666;">
                â† å…¨æ–½è¨­ã®Lvä¸Šé™
            </div>
        </div>
        <div class="input-row">
            <div class="col-label">ä½å±…<span class="col-desc">ã‚¢ãƒ«ãƒ•ã‚¡</span></div>
            <div class="col-lv"><input type="number" id="lvHousing" class="input-lv" value="14" oninput="updateHousing()" onkeydown="moveFocus(event, 'lvFood')"></div>
            <div class="col-val">
                <input type="number" id="totalPop" class="input-res" placeholder="ç·äººå£" oninput="calculate()" onkeydown="moveFocus(event, 'lvFood')">
                <span style="font-size:11px; align-self:center;">äºº</span>
            </div>
        </div>
        <div class="input-row">
            <div class="col-label">é£Ÿç³§åº«<span class="col-desc">ãƒ‡ãƒ«ã‚¿</span></div>
            <div class="col-lv"><input type="number" id="lvFood" class="input-lv" value="14" oninput="calculate()" onkeydown="moveFocus(event, 'lvStone')"></div>
            <div class="col-val" style="justify-content:flex-end; font-size:11px; color:#aaa; align-items:center;">
                æœ€å¤§ç¶­æŒ: <span id="supplyFood" style="color:#fff; font-weight:bold; font-size:13px; margin:0 4px;">-</span>äºº
            </div>
        </div>
    </div>

    <div class="card">
        <div class="row-header">
            <span class="h-name">æ–½è¨­å</span>
            <span class="h-lv">Lv</span>
            <span class="h-val">æ‰€æŒ / <b>ç›®æ¨™ã‚³ã‚¹ãƒˆ</b></span>
        </div>

        <div class="input-row">
            <div class="col-label">
                çŸ³ææ‰€<span class="col-desc">ãƒ™ãƒ¼ã‚¿</span>
            </div>
            <div class="col-lv"><input type="number" id="lvStone" class="input-lv" value="14" oninput="calculate()" onkeydown="moveFocus(event, 'lvWood')"></div>
            <div class="col-val">
                <input type="number" id="curStone" class="input-res" placeholder="æ‰€æŒ" oninput="calculate()" onkeydown="moveFocus(event, 'curWood')">
                <span style="color:#666">/</span>
                <input type="number" id="tarStone" class="input-res" placeholder="å¿…è¦æ•°" style="border-color:#666;" oninput="calculate()" onkeydown="moveFocus(event, 'tarWood')">
            </div>
        </div>

        <div class="input-row">
            <div class="col-label">
                æœ¨ææ‰€<span class="col-desc">ã‚¤ãƒ—ã‚·ãƒ­ãƒ³</span>
            </div>
            <div class="col-lv"><input type="number" id="lvWood" class="input-lv" value="14" oninput="calculate()" onkeydown="moveFocus(event, 'lvCoin')"></div>
            <div class="col-val">
                <input type="number" id="curWood" class="input-res" placeholder="æ‰€æŒ" oninput="calculate()" onkeydown="moveFocus(event, 'curCoin')">
                <span style="color:#666">/</span>
                <input type="number" id="tarWood" class="input-res" placeholder="å¿…è¦æ•°" style="border-color:#666;" oninput="calculate()" onkeydown="moveFocus(event, 'tarCoin')">
            </div>
        </div>

        <div class="input-row">
            <div class="col-label">
                å•†å“å·¥å ´<span class="col-desc">ã‚¬ãƒ³ãƒ</span>
            </div>
            <div class="col-lv"><input type="number" id="lvCoin" class="input-lv" value="14" oninput="calculate()"></div>
            <div class="col-val">
                <input type="number" id="curCoin" class="input-res" placeholder="æ‰€æŒ" oninput="calculate()">
                <span style="color:#666">/</span>
                <input type="number" id="tarCoin" class="input-res" placeholder="å¿…è¦æ•°" style="border-color:#666;" oninput="calculate()">
            </div>
        </div>
    </div>

    <div id="strategyCard" class="strategy-card">
        <div class="strategy-title">COMMAND CENTER</div>
        <div id="strategyAction" class="strategy-action">...</div>
        <div id="strategyReason" class="strategy-reason"></div>
    </div>

    <div class="card" id="resultCard" style="display:none;">
        <div id="statusText" style="text-align:center; font-size:12px; margin-bottom:10px; color:#aaa;"></div>
        <div id="rowsArea"></div>
        <div id="timeEstimate" style="margin-top:15px; text-align:center; font-size:13px; color:var(--accent-color); font-weight:bold;"></div>
    </div>
    
    <div style="text-align:center;">
        <button class="reset-btn" onclick="resetData()">å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

</div>

<script>
    const BASE = { stone: 20, wood: 20, coin: 100, food: 20 };
    const MULT = { stone: 1, wood: 1, coin: 5, food: 4 };
    const CAPS = [0,10,20,30,40,60,80,120,170,220,300,320,340,360,380,400,420,440,460,480,500];
    const HOUSING = [0,20,45,80,130,200,300,440]; 
    const IDS = ['lvBase','lvHousing','totalPop','lvFood','lvStone','curStone','tarStone','lvWood','curWood','tarWood','lvCoin','curCoin','tarCoin'];
    const STORAGE_KEY = 'kagemasu_date_fix';

    function getCap(lv) { return (!lv||lv<1)?10 : (lv>20?500 : CAPS[lv]); }
    function getHouse(lv) { return (!lv||lv<1)?20 : (lv<HOUSING.length?HOUSING[lv] : getCap(lv)*4); }
    
    // ç¸¦ç§»å‹•ï¼ˆEnterã‚­ãƒ¼ï¼‰å‡¦ç†é–¢æ•°
    function moveFocus(e, nextId) {
        if (e.key === 'Enter') {
            e.preventDefault();
            const next = document.getElementById(nextId);
            if (next) { next.focus(); next.select(); }
        }
    }

    function init() {
        const s = localStorage.getItem(STORAGE_KEY);
        if(s) { try{ const d=JSON.parse(s); IDS.forEach(id=>{ const e=document.getElementById(id); if(e && d[id]) e.value=d[id]; }); }catch(e){} }
        
        // äººå£ãŒç©ºã€ã¾ãŸã¯0ã®å ´åˆã¯ã€ä½å±…Lvã‹ã‚‰å†è¨ˆç®—ã™ã‚‹
        const pop = document.getElementById('totalPop').value;
        if(!pop || pop == "0") {
            updateHousing();
        } else {
            calculate();
        }
    }
    
    function resetData() {
        if(confirm("ã™ã¹ã¦ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’æ¶ˆå»ã—ã¦ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ")) {
            localStorage.removeItem(STORAGE_KEY);
            location.reload();
        }
    }
    
    function updateHousing() {
        const lv = parseInt(document.getElementById('lvHousing').value)||1;
        document.getElementById('totalPop').value = getHouse(lv);
        calculate();
    }

    function calculate() {
        // Save
        const d={}; IDS.forEach(id=>{ const e=document.getElementById(id); if(e) d[id]=e.value; });
        localStorage.setItem(STORAGE_KEY, JSON.stringify(d));

        // Inputs
        const lvBase = parseInt(document.getElementById('lvBase').value)||1;
        const totalPop = parseInt(document.getElementById('totalPop').value)||0;
        
        const lvs = {
            house: parseInt(document.getElementById('lvHousing').value)||1,
            food: parseInt(document.getElementById('lvFood').value)||1,
            stone: parseInt(document.getElementById('lvStone').value)||1,
            wood: parseInt(document.getElementById('lvWood').value)||1,
            coin: parseInt(document.getElementById('lvCoin').value)||1
        };
        const caps = { food: getCap(lvs.food), stone: getCap(lvs.stone), wood: getCap(lvs.wood), coin: getCap(lvs.coin) };
        const cur = { stone: parseInt(document.getElementById('curStone').value)||0, wood: parseInt(document.getElementById('curWood').value)||0, coin: parseInt(document.getElementById('curCoin').value)||0 };
        const tar = { stone: parseInt(document.getElementById('tarStone').value)||0, wood: parseInt(document.getElementById('tarWood').value)||0, coin: parseInt(document.getElementById('tarCoin').value)||0 };

        document.getElementById('supplyFood').textContent = 20 + (caps.food * 4);

        // --- Logic Step 1: Population ---
        const reqFoodDelta = Math.ceil((totalPop - 20) / 4);
        const allocFood = Math.max(0, Math.min(reqFoodDelta, caps.food));
        const sustainablePop = 20 + (allocFood * 4);
        let workingPop = totalPop;
        let isStarving = false;
        if (totalPop > sustainablePop) {
            workingPop = sustainablePop;
            isStarving = true;
        }

        // --- Logic Step 2: Allocation (Min-Max Time Strategy) ---
        let need = {
            stone: Math.max(0, tar.stone - cur.stone),
            wood:  Math.max(0, tar.wood  - cur.wood),
            coin:  Math.max(0, tar.coin  - cur.coin)
        };
        
        let free = workingPop - allocFood;
        let alloc = { stone: 0, wood: 0, coin: 0 };
        let full = { stone: false, wood: false, coin: false };
        let safety = (totalPop > 0 ? totalPop : 1000) * 2; // å®‰å…¨è£…ç½®
        
        // äººå£ãŒå°½ãã‚‹ã¾ã§ã€1äººãšã¤ã€Œæœ€ã‚‚é…ã‚Œã¦ã„ã‚‹æ–½è¨­ã€ã¸å‰²ã‚Šå½“ã¦ã‚‹
        while (free > 0 && safety > 0) {
            safety--;
            let bestFacility = null;
            let worstTime = -1;
        
            for (const key of ['stone', 'wood', 'coin']) {
                if (full[key]) continue;
                if (alloc[key] >= caps[key]) {
                    full[key] = true;
                    continue;
                }
        
                // ç¾åœ¨ã®ç”Ÿç”£åŠ› = åŸºç¤ç”Ÿç”£ + (é…å±æ•° * å€ç‡)
                const currentProd = BASE[key] + (alloc[key] * MULT[key]);
                const remainingNeed = need[key] > 0 ? need[key] : 1; // å®Œäº†æ¸ˆã¿ã§ã‚‚å‡ç­‰é…ç½®ã®ãŸã‚1ã¨ã¿ãªã™
                
                let timeScore;
                if (currentProd === 0) {
                    // ç”Ÿç”£åŠ›0ãªã‚‰ç„¡é™å¤§æ™‚é–“ã‹ã‹ã‚‹ï¼æœ€å„ªå…ˆ
                    timeScore = 999999999 + remainingNeed; 
                } else {
                    // æ®‹ã‚Šæ™‚é–“ = æ®‹ã‚Šå¿…è¦æ•° / ç¾åœ¨ã®ç”Ÿç”£åŠ›
                    timeScore = remainingNeed / currentProd;
                }
        
                if (timeScore > worstTime) {
                    worstTime = timeScore;
                    bestFacility = key;
                }
            }
        
            if (bestFacility === null) break;
        
            alloc[bestFacility]++;
            free--;
            // needã¯ã“ã“ã§ã¯æ¸›ã‚‰ã•ãªã„ï¼ˆç”Ÿç”£åŠ›ãŒå‹•çš„ã«å¤‰ã‚ã‚‹ãŸã‚ã€æ¯å›Timeã‚’å†è¨ˆç®—ã™ã‚‹ï¼‰
        }

        // --- Logic Step 3: Advice Strategy ---
        const stCard = document.getElementById('strategyCard');
        const stAction = document.getElementById('strategyAction');
        const stReason = document.getElementById('strategyReason');
        let action = ""; let reason = ""; let color = "";

        if (isStarving) {
            color = "var(--danger-color)";
            stCard.style.background = "rgba(255, 107, 107, 0.1)";
            if (allocFood >= caps.food) {
                 if (lvs.food < lvBase) { action = "é£Ÿç³§åº«ã‚’LvUPæ¨å¥¨"; reason = "æº€å“¡ã§äººå“¡ç¶­æŒä¸èƒ½"; }
                 else { action = "æ‹ ç‚¹(æ‹ ç‚¹)ã‚’LvUPæ¨å¥¨"; reason = "é£Ÿç³§åº«ãŒä¸Šé™åˆ°é”"; }
            } else { action = "äººå“¡é…åˆ†ã‚¨ãƒ©ãƒ¼"; reason = "é£Ÿæ–™ç”Ÿç”£å„ªå…ˆ"; }
        } else {
            let jammed = [];
            if (totalPop >= getHouse(lvs.house) && lvs.house < lvBase) jammed.push({name:"ä½å±…", p:1, lv:lvs.house, c:0});
            if (full.stone && lvs.stone < lvBase) jammed.push({name:"çŸ³ææ‰€", p:2, lv:lvs.stone, c:cur.stone});
            if (full.wood && lvs.wood < lvBase) jammed.push({name:"æœ¨ææ‰€", p:2, lv:lvs.wood, c:cur.wood});
            if (full.coin && lvs.coin < lvBase) jammed.push({name:"å•†å“å·¥å ´", p:2, lv:lvs.coin, c:cur.coin});

            if (jammed.length > 0) {
                color = "var(--warn-color)";
                stCard.style.background = "rgba(255, 204, 0, 0.1)";
                jammed.sort((a,b) => {
                    if(a.p !== b.p) return a.p - b.p; 
                    if(a.lv !== b.lv) return a.lv - b.lv; 
                    return a.c - b.c;
                });
                let t = jammed[0];
                action = `${t.name}ã‚’LvUPæ¨å¥¨`;
                reason = `${t.name}ãŒæº€å“¡ã‹ã¤ã€æ‰€æŒãƒªã‚½ãƒ¼ã‚¹ãŒæœ€ã‚‚æ¯æ¸‡ã—ã¦ã„ã‚‹ãŸã‚å¼·åŒ–ãŒæœ€å–„ã§ã™ã€‚`;
            } else if (workingPop < (caps.stone + caps.wood + caps.coin + allocFood)) {
                if (lvs.house < lvBase) {
                    color = "var(--accent-color)";
                    stCard.style.background = "rgba(96, 205, 255, 0.1)";
                    action = "ä½å±…ã‚’LvUP / äººå“¡å¢—åŠ ";
                    reason = "æ–½è¨­ã«ç©ºãã‚ã‚Šã€‚äººå“¡ãŒå¿…è¦ã§ã™ã€‚";
                } else if (totalPop < getHouse(lvs.house)) {
                    color = "#aaa";
                    stCard.style.background = "rgba(255,255,255,0.05)";
                    action = "æ¢ç´¢ / æ™‚é–“çµŒéå¾…ã¡";
                    reason = "ä½å±…æ ã¯ã‚ã‚Šã¾ã™ã€‚äººå£å¢—åŠ ã‚’å¾…ã£ã¦ãã ã•ã„ã€‚";
                } else {
                    color = "var(--success-color)";
                    stCard.style.background = "rgba(102, 255, 153, 0.1)";
                    action = "æ‹ ç‚¹ã‚’LvUPæ¨å¥¨";
                    reason = "å…¨æ–½è¨­ãŒæœ€é©ç¨¼åƒä¸­ã€‚æ‹ ç‚¹Lvã‚’ä¸Šã’ã¦ãã ã•ã„ã€‚";
                }
            }
        }

        stCard.style.borderColor = color;
        stCard.style.display = 'block';
        stAction.textContent = action;
        stReason.textContent = reason;

        // --- Logic Step 4: Render Results ---
        const prod = {
            stone: BASE.stone + (alloc.stone*MULT.stone),
            wood: BASE.wood + (alloc.wood*MULT.wood),
            coin: BASE.coin + (alloc.coin*MULT.coin)
        };
        const time = {
            stone: need.stone>0 ? need.stone/prod.stone : 0,
            wood: need.wood>0 ? need.wood/prod.wood : 0,
            coin: need.coin>0 ? need.coin/prod.coin : 0
        };
        const maxTime = Math.max(time.stone, time.wood, time.coin);

        document.getElementById('resultCard').style.display = 'block';
        document.getElementById('statusText').innerHTML = isStarving 
            ? `<span style="color:var(--danger-color); font-weight:bold;">âš ï¸ é£Ÿæ–™ä¸è¶³</span>: ${workingPop}äººã§ç¨¼åƒä¸­`
            : `ç¨¼åƒ: ${workingPop}äºº / <span style="color:#888">ç©ºå¸­: ${(caps.stone+caps.wood+caps.coin+caps.food) - workingPop}</span>`;

        const renderRow = (label, val, cap, prodVal, timeLeft) => {
            let badge = (val >= cap) ? `<span class="res-full">æº€å“¡</span>` : `<span class="res-ok">ç©ºã</span>`;
            let timeStr = (timeLeft > 0) ? `ã‚ã¨${timeLeft.toFixed(1)}h` : `<span style="color:var(--success-color)">é”æˆ</span>`;
            if (val === 0 && timeLeft > 0) timeStr = "åœæ­¢ä¸­";

            return `
            <div class="result-row">
                <div style="width:35%;">
                    <div style="font-weight:bold;">${label} ${badge}</div>
                </div>
                <div style="width:65%; text-align:right;">
                    <div style="color:var(--accent-color); font-weight:bold; font-size:15px;">${val} äºº</div>
                    <div style="font-size:11px; color:#aaa;">ç”Ÿç”£: ${prodVal}/h (${timeStr})</div>
                </div>
            </div>`;
        };

        let html = "";
        let fBadge = (allocFood >= caps.food) ? `<span class="res-full">æº€å“¡</span>` : `<span class="res-ok">ä½™è£•</span>`;
        html += `
            <div class="result-row">
                <div style="width:35%;">
                    <div style="font-weight:bold;">é£Ÿç³§åº« ${fBadge}</div>
                </div>
                <div style="width:65%; text-align:right;">
                    <div style="color:var(--accent-color); font-weight:bold; font-size:15px;">${allocFood} äºº</div>
                    <div style="font-size:11px; color:#aaa;">ç¶­æŒ: ${sustainablePop}äººåˆ†</div>
                </div>
            </div>`;

        html += renderRow("çŸ³ææ‰€", alloc.stone, caps.stone, prod.stone, time.stone);
        html += renderRow("æœ¨ææ‰€", alloc.wood, caps.wood, prod.wood, time.wood);
        html += renderRow("å•†å“å·¥å ´", alloc.coin, caps.coin, prod.coin, time.coin);

        document.getElementById('rowsArea').innerHTML = html;

        if(maxTime > 0.001) {
            const fin = new Date(new Date().getTime() + maxTime*3600000);
            const Y = fin.getFullYear();
            const M = ('0'+(fin.getMonth()+1)).slice(-2);
            const D = ('0'+fin.getDate()).slice(-2);
            const h = ('0'+fin.getHours()).slice(-2);
            const m = ('0'+fin.getMinutes()).slice(-2);
            const s = ('0'+fin.getSeconds()).slice(-2);
            document.getElementById('timeEstimate').innerHTML = `ç›®æ¨™é”æˆç›®å®‰: ${Y}/${M}/${D} ${h}:${m}:${s}`;
        } else {
            document.getElementById('timeEstimate').innerHTML = "ç›®æ¨™é”æˆæ¸ˆã¿";
        }
    }
</script>
</body>
</html>